# 람다로 프로그래밍
- 람다 식 또는 람다는 기본적으로 다른 함수에 넘길 수 있는 작은 코드 조각을 뜻한다.

>  5.1 람다식과 멤버 참조
- 람다 이전에는 무명 내부 클래스를 사용하여 함수에  넘기거나 해서.. 사용했는데 번거롭다.
```java
button.setOnClickListener(new onClickListener() {
    @Override
    public void onClick(View  view) {
        }
});
```
- 하지만 함수형 프로그래밍에서는 함수를 값처럼 취급하는 접근방법으로 이 문제를 해결한다.
    + 클래스를 선언하고 인스턴스를 넘기는 대신, 함수를  넘긴다. 
```java
button.setOnClickListener(view -> {});
```

### 람다와 컬렉션 
- 코틀린에서는 필요한 컬렉션 기능을 직접 작성하거나, 번거로운 작업을 했던 습관은 버려야 한다. 대신 컬렉션에서 제공하는 라이브러리 함수를 주로 사용하자.
```kotlin
// 직접 구현
fun findTheOldest (people:List<Person>) {
 ...
}

val people = listOf(Person("alice",29), Person("bob",  31))

//findTheOldest(people)     // 좋지 않다.
people.maxBy  { it.age }    // 람다 사용
people.maxBy(Person::age)   // 멤버  참조
```


### 람다식의 문법
- 람다식은 항상 중괄호로  둘러싸여 있다. 
```kotlin
            // 파라미터         // 본문
val sum  = { x: Int, y: Int -> x + y }
```
- 람다 표현 방법
```kotlin
// 코틀린에서 코드를 줄여쓸 수 있는 기능을 제거하면
people.maxBy({p: Persson -> p.age}) //번잡하고, 구분자가 많아서 가독성이 떨어진다.
people.maxBy() {p: Person -> p.age} //코틀린에서 맨뒤에 있는 인자가 람다라면, 람다를 괄호 밖으로 뺄 수 있다.
people.maxBy {p: Person -> p.age} // 함수의 유일한 인자가 람다라면 ()괄호를 생략해도 된다.
```
- 람다 괄호밖으로 빼기
```kotlin
val people = listOf(Person("alice",29), Person("bob",  31))

people.joinToString(separator=" ", transform = {p: Person -> p.name})   // default
people.joinToString(separator=" ") {p: Person -> p.name}   // 마지막 인자는 밖으로 뺄 수 있다. - 관습
```
- 람다의 파라미터가 하나뿐이고   컴파일러가 타입을  추론할 수 있으면, it을 쓸 수 있다.
- it 사용을 남용하면 안된다. 특히 람다 안에 람다가 중첩된 경우 파라미터를 명시하는게 낫다. 그렇지 않으면, it이 어떤 람다에 속했는지 어렵다.
```kotlin
val getAge = { p: Person -> p.age }
people.maxBy(getAge)    // 파라미터 명시
```

- 코틀린에서는 자바와 달리 람다에서 람다 밖 함수에 있는 파이널이 아닌 변수에 접근할 수 있고 변경도 가능하다.
    + 이를 '람다가 포획한 변수' 라고 부른다.
```kotlin
// 변경가능한 변수 포획하기: 구현방법
class Ref<T>(var value:T)

val counter = Ref(0)
val inc = { counter.value++ }

// 아래 코드의 내부 구현 모습은 위와 같다.
// 람다가 파이널 변수를 포획하면 자바와 마찬가지로 변수의 값이 복사된다. 
// 하지만 변경 불가능한 값을 포획하면, 변수를 ref 클래스 인스턴스에 넣는다. 그리고 ref 인스턴스에 대한 참조를 final로 만든다.
var  counter = 0
val inc = { counter++ }
   
```    

### 멤버 참조
- 람다를 사용해 코드 블록을 다른 함수로 넘기는 방법 말고, 이미 구현된 함수를 넘기려고할 때 멤버 참조를 사용하면 된다.
```kotlin
val getAge = Person::getAge 

fun salute() = prinntln("Salute!")
run(::salute)   // 최상위에 선언된 함수나 프로퍼티 참조 가능
  
```    
- 멤버 참조와 람다 비교
```kotlin
val action = {person:Person, message:Message -> sendEmail(person, message)}// 이 람다는 sendEmail에 작업을 위임한다.
val nextAction = ::sendEmail  // 람다 대신 멤버 참조 사용 
```

- 생성자참조를사용하면 클래스 생성작업을 연기하거나 저장해둘 수도 있다.
```kotlin
data class Person(val name: String,   val age:Int)

val  createPerson = ::Person
val p = createPerson("bob", 3) 
```
